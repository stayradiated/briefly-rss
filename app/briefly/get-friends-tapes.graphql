query GetFriendsTapes($now: timestamptz, $user_id: uuid!) {
  friend(
    where: { user_id: { _eq: $user_id } }
    order_by: {
      friend_profile: {
        tapes_aggregate: { max: { created_at: desc_nulls_last } }
      }
    }
  ) {
    friend_profile {
      id
      username
      avatar_id
      tapes(
        order_by: { created_at: desc }
        where: { expires_at: { _gt: $now } }
      ) {
        id
        duration
        created_at
        path
        is_public
        tape_snap_files(limit: 1) {
          id
        }
        comments_aggregate {
          aggregate {
            count
          }
        }
      }
    }
  }
}
